-- superDirt config and testing
MIDIClient.init;

MIDIClient.destinations;

~midiOut = MIDIOut.newByName("TidalToHydra", "TidalToHydra"); // substitute your own device here

~dirt.soundLibrary.addMIDI(\hydra, ~midiOut);


~midiOut.latency = 0;
~midiOut.noteOn(0, 60, 100);  // should light up the IAC driver port
~midiOut.noteOff(0, 60, 0);


--- SC display midi events


(
MIDIClient.init;
MIDIIn.connectAll;
MIDIdef.noteOn(\test,
  { |vel, num, chan, src|
    ("noteOn: " ++ num ++ " velocity: " ++ vel).postln;
  }
);
MIDIdef.noteOff(\test,
  { |vel, num, chan, src|
    ("noteOff: " ++ num).postln;
  }
);
)




-- actual tidal MIDI to Hydra
d1 $ note "60 ~ 60 ~ 60"
  # octave 0
  # s "hydra"
  # sustain 0.2

let pat = "0 1 1 0 1 0 1 0"

d2 $ slow 1 $ struct pat $ n "60" # s "hydra" # sustain 0.5

d3 $ struct pat $ s "bd sd" # gain 0.99
